(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"0aSZ":function(t,e,n){},"4G/S":function(t,e,n){"use strict";var i=n("0aSZ"),s=n.n(i);s.a},"8KLx":function(t,e,n){},"Lwp/":function(t,e,n){"use strict";var i=n("8KLx"),s=n.n(i);s.a},QZ2B:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"match-result-sheet"},t._l([0,1],function(e){return n("MatchResultSheetRow",{key:e,attrs:{player:"string"===typeof t.match["player"+(e+1)]?{}:t.match["player"+(e+1)],"win-rate":t.winRates[e],"result-list":t.resultLists[e],result:t.result[e],"points-assigned":t.match.pointsAssigned&&t.match.pointsAssigned[e],"show-border":0===e,"is-winner":void 0===t.winner?void 0:t.winner===e,"is-current-server":t.currentServer===e}})}))},s=[],a=n("k5N+"),r=(n("SRfc"),n("xfY5"),n("VRzm"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"match-result-sheet-row",class:{border:t.showBorder,winner:t.isWinner}},[n("span",{staticClass:"name"},[n("span",{staticClass:"prefix"},[t._v(t._s(t.prefix))]),t._v(t._s(t.player.fullname)),t.pointsAssigned?n("sup",[t._v(t._s(t.pointsAssigned>0?"+":"")+t._s(t.pointsAssigned))]):t._e(),t.pointsAssigned||void 0===t.winRate?t._e():n("sup",[t._v("("+t._s(t.winRate)+"%)")])]),t._l(t.resultList,function(e,i){return n("span",{key:i,staticClass:"score",class:{odd:i%2!==0,even:i%2===0}},[t._v(t._s(e))])}),n("span",{staticClass:"result"},[t._v(t._s(t.result))])],2)}),c=[],o={name:"MatchResultSheetRow",props:{player:{type:Object,default:function(){return{}}},winRate:{type:Number,default:void 0},resultList:{type:Array,default:function(){return[]}},result:{type:Number,default:0},pointsAssigned:{type:Number,default:0},isWinner:{type:Boolean,default:void 0},isCurrentServer:{type:Boolean,default:!1},showBorder:{type:Boolean,default:!1}},computed:{prefix:function(){return!0===this.isWinner?"🏆":void 0===this.isWinner&&this.isCurrentServer?"🏓":""}}},u=o,h=(n("Lwp/"),n("KHd+")),l=Object(h["a"])(u,r,c,!1,null,"6478e6c8",null),d=l.exports,f={name:"MatchResultSheet",components:{MatchResultSheetRow:d},props:{match:{type:Object,default:function(){return{}}},currentServer:{type:Number,default:void 0}},data:function(){return{playersHistory:void 0}},computed:{winRates:function(){if(this.playersHistory){if(0===this.playersHistory.total)return[void 0,void 0];var t=Math.ceil(this.playersHistory[this.match.player1.id]/this.playersHistory.total*100);return[t,100-t]}return[void 0,void 0]},resultLists:function(){var t=[[],[]];return this.match.resultTable.map(function(e){var n=Object(a["a"])(e,2),i=n[0],s=n[1];t[0].push(i),t[1].push(s)}),t},result:function(){var t=this;return this.match.resultTable.reduce(function(e,n){return n[0]-n[1]>=2&&n[0]>=t.match.pointsPerSet&&(e[0]+=1),n[1]-n[0]>=2&&n[1]>=t.match.pointsPerSet&&(e[1]+=1),e},[0,0])},isMatchFinished:function(){var t=Math.ceil(this.match.numberOfSets/2);return this.result[0]===t||this.result[1]===t},winner:function(){return this.isMatchFinished?this.result[0]>this.result[1]?0:1:void 0}},mounted:function(){var t=this;this.match.finished||this.$fns.httpsCallable("getPlayersHistory")({player1:this.match.player1.id,player2:this.match.player2.id}).then(function(e){var n=e.data;console.log(n),t.playersHistory=n}).catch(function(){console.error("Failed to load players history.")})}},p=f,v=(n("tY13"),Object(h["a"])(p,i,s,!1,null,null,null));e["a"]=v.exports},Ulsr:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"matches"},[n("f7-navbar",{staticClass:"bg-color-white",attrs:{title:"Matches","no-hairline":""}}),t.isInitialLoadingFinished?[n("h3",[t._v("Live Matches")]),n("ul",{staticClass:"match-list"},t._l(t.unfinishedMatches,function(e){return n("li",{key:e.id,on:{click:function(n){t.viewMatch(e)}}},[n("span",{staticClass:"date"},[t._v(t._s(t.distanceInWordsToNow(e.createdAt)))]),n("match-result-sheet",{attrs:{match:e}})],1)})),n("p",{directives:[{name:"show",rawName:"v-show",value:0===t.unfinishedMatches.length,expression:"unfinishedMatches.length === 0"}]},[t._v("Click PLAY to start a match now!")]),n("h3",[t._v("Finished Matches")]),n("ul",{staticClass:"match-list"},t._l(t.finishedMatches,function(e){return n("li",{key:e.id,on:{click:function(n){t.viewMatch(e)}}},[n("span",{staticClass:"date"},[t._v(t._s(t.format(e.finishedAt)))]),n("match-result-sheet",{attrs:{match:e}})],1)})),n("p",{directives:[{name:"show",rawName:"v-show",value:0===t.finishedMatches.length,expression:"finishedMatches.length === 0"}]},[t._v("No match history.")])]:n("loader")],2)},s=[],a=(n("INYr"),n("Z2Ku"),n("L9s1"),n("yT7P")),r=(n("rGqo"),n("yt8O"),n("RW0V"),n("Kw5r")),c=n("vDqi"),o=n.n(c),u=n("cPJV"),h=n.n(u),l=n("YlT8"),d=n.n(l),f=n("VV+c"),p=n("QZ2B"),v=30,m={name:"Matches",components:{Loader:f["a"],MatchResultSheet:p["a"]},data:function(){return{isInitialLoadingFinished:!1,page:0,finishedMatchIds:[],finishedMatches:[],unfinishedMatches:[]}},computed:{user:function(){return this.$root.user},totalPage:function(){return Math.ceil(this.finishedMatchIds.length/v)},canLoadMore:function(){return this.page<this.totalPage}},created:function(){var t=this;this.$db.ref("matches").orderByChild("finishedAt").equalTo(null).once("value").then(function(e){var n=e.val()||{},i=Object.keys(n);t.unfinishedMatches=i.map(function(t){return Object(a["a"])({},n[t],{id:t})}),t.unfinishedMatches.forEach(function(e){t.loadUserInfo(e)}),o.a.get("https://uwtta-web-app.firebaseio.com/matches.json?shallow=true").then(function(e){var n=e.data;t.finishedMatchIds=Object.keys(n||{}).filter(function(t){return!i.includes(t)}),t.isInitialLoadingFinished=!0,t.loadMore()})}),this.$db.ref("matches").orderByChild("createdAt").startAt(Date.now()).on("child_added",function(e){t.unfinishedMatches.unshift(Object(a["a"])({},e.val(),{id:e.key})),t.loadUserInfo(t.unfinishedMatches[0])}),this.$db.ref("matches").on("child_removed",function(e){var n=t.unfinishedMatches.findIndex(function(t){return t.id===e.key});-1!==n&&r["a"].delete(t.unfinishedMatches,n)}),this.$db.ref("matches").on("child_changed",function(e){var n,i=e.val();return i.id=e.key,n=t.unfinishedMatches.findIndex(function(t){return i.id===t.id}),-1!==n?i.finished?(r["a"].delete(t.unfinishedMatches,n),t.finishedMatches.push(i)):t.updateMatchChange(t.unfinishedMatches[n],i):(n=t.finishedMatches.findIndex(function(t){return i.id===t.id}),-1!==n?t.updateMatchChange(t.finishedMatches[n],i):void 0)})},methods:{format:function(t){return h()(new Date(t),"YYYY-MM-DD HH:mm")},distanceInWordsToNow:function(t){return d()(new Date(t))},loadMore:function(){var t=this;this.canLoadMore&&Promise.all(this.finishedMatchIds.slice(this.page*v,(this.page+1)*v).map(function(e){return t.$db.ref("matches/".concat(e)).once("value")})).then(function(e){e.forEach(function(e){t.finishedMatches.unshift(Object(a["a"])({},e.val(),{id:e.key})),t.loadUserInfo(t.finishedMatches[0])})})},updateMatchChange:function(t,e){delete e.createdBy,delete e.judge,delete e.player1,delete e.player2,Object.keys(e).forEach(function(n){r["a"].set(t,n,e[n])})},loadUserInfo:function(t){var e=this;["createdBy","judge","player1","player2"].forEach(function(n){e.$db.ref("users/".concat(t[n])).on("value",function(e){r["a"].set(t,n,Object(a["a"])({},e.val(),{id:e.key}))})})},viewMatch:function(t){var e=this;if("string"!==typeof t.createdBy&&"string"!==typeof t.judge&&"string"!==typeof t.player1&&"string"!==typeof t.player2){var n,i="".concat(t.player1.emoji).concat(t.player1.fullname," vs. ").concat(t.player2.fullname).concat(t.player2.emoji);n=t.finished?"Wanna view details of this match?":[t.createdBy.id,t.judge.id].includes(this.user&&this.user.uid)?"Judge, we are waiting for you! Ready to continue?":"Wanna watch this live match?",this.$f7.dialog.confirm(n,i,function(){e.$f7router.navigate("/scoreboard/".concat(t.id))})}}}},y=m,M=(n("4G/S"),n("KHd+")),g=Object(M["a"])(y,i,s,!1,null,"149f9b71",null);e["default"]=g.exports},"VV+c":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("img",{staticClass:"loader",attrs:{src:n("WbWX")}})},s=[],a={name:"Loader"},r=a,c=(n("xqeh"),n("KHd+")),o=Object(c["a"])(r,i,s,!1,null,"1b069888",null);e["a"]=o.exports},WbWX:function(t,e,n){t.exports=n.p+"img/ping-pong.0bd675f4.gif"},hSuW:function(t,e,n){},tY13:function(t,e,n){"use strict";var i=n("vAUg"),s=n.n(i);s.a},vAUg:function(t,e,n){},xqeh:function(t,e,n){"use strict";var i=n("hSuW"),s=n.n(i);s.a}}]);
//# sourceMappingURL=6.7514b338.js.map